<?php//===============================================================class PluginReceptiondesk_ModuleCategory_MapperCategory extends Mapper{//===============================================================	public function AddCategory(PluginReceptiondesk_ModuleCategory_EntityCategory $oCategory){		$sql="INSERT INTO ".Config::Get('db.table.receptiondesk_categories')." (category_title,category_url,category_description) VALUES(?,?,?);";		if($iCategoryId=$this->oDb->query($sql,$oCategory->getTitle(),$oCategory->getUrl(),$oCategory->getDescription())) return $iCategoryId;		return false;	}//===============================================================	public function UpdateCategory(PluginReceptiondesk_ModuleCategory_EntityCategory $oCategory){		$sql="UPDATE ".Config::Get('db.table.receptiondesk_categories')." SET category_title=?,category_url=?,category_description=?,category_count_question=?d WHERE category_id=?d;";		if($this->oDb->query($sql,$oCategory->getTitle(),$oCategory->getUrl(),$oCategory->getDescription(),$oCategory->getCountQuestion(),$oCategory->getId())!==false) return true;		return false;	}//===============================================================	public function DeleteCategory(PluginReceptiondesk_ModuleCategory_EntityCategory $oCategory){		$sql="DELETE FROM ".Config::Get('db.table.receptiondesk_categories')." WHERE category_id=?d;";		if($aRow=$this->oDb->query($sql,$oCategory->getId())!=false) return true;		return false;	}//===============================================================	public function GetCountCategory(){		$sql="SELECT count(*) AS count FROM ".Config::Get('db.table.receptiondesk_categories').";";		if($aRow=$this->oDb->selectRow($sql)) return $aRow['count'];		return null;	}//===============================================================	public function GetCategoryByTitle($sCategoryTitle){		$sql="SELECT category_id FROM ".Config::Get('db.table.receptiondesk_categories')." WHERE category_title=?;";		if($aRow=$this->oDb->selectRow($sql,$sCategoryTitle)) return $aRow['category_id'];		return null;	}//===============================================================	public function GetCategoryByUrl($sCategoryUrl){		$sql="SELECT category_id FROM ".Config::Get('db.table.receptiondesk_categories')." WHERE category_url=?;";		if($aRow=$this->oDb->selectRow($sql,$sCategoryUrl)) return $aRow['category_id'];		return null;	}//===============================================================	public function GetCategories(){		$aCategories=array();		$sql="SELECT category_id FROM ".Config::Get('db.table.receptiondesk_categories')." ORDER BY category_id DESC;";		if($aRows=$this->oDb->select($sql)) foreach($aRows as $aRow) $aCategories[]=$aRow['category_id'];		return $aCategories;	}//===============================================================	public function GetCategoryByArrayId($aArrayId,$aOrder=null){		if(!is_array($aArrayId) || count($aArrayId)==0) return array();		if(!is_array($aOrder)) $aOrder=array($aOrder);		$sOrder='';		foreach($aOrder as $key=>$value){			$value=(string)$value;			if(!in_array($key,array('category_id','category_title','category_url'))){				unset($aOrder[$key]);			}elseif (in_array($value,array('asc','desc'))) {				$sOrder.=" {$key} {$value},";			}		}		$sOrder=trim($sOrder,',');		$sql="SELECT * FROM ".Config::Get('db.table.receptiondesk_categories')." WHERE category_id IN(?a) ORDER BY { FIELD(category_id,?a) } ";		if($sOrder!='') $sql.=$sOrder;		$aCategories=array();		if($aRows=$this->oDb->select($sql,$aArrayId,$sOrder=='' ? $aArrayId : DBSIMPLE_SKIP)) foreach($aRows as $aRow) $aCategories[]=Engine::GetEntity('PluginReceptiondesk_ModuleCategory_EntityCategory',$aRow);		return $aCategories;	}//===============================================================}?>